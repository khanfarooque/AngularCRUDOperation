
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <script src="~/Scripts/angular.min.js"></script>
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" />
    <script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.1/xlsx.full.min.js"></script>
    <script src="http://oss.sheetjs.com/js-xlsx/jszip.js"></script>
    @*<script src="~/Scripts/table2excel.js"></script>*@
    <!--<script src="~/Scripts/ImportExcel.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alasql/0.4.9/alasql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.4/xlsx.core.min.js"></script>

    <script type="text/javascript">

    </script>
</head>
<body ng-app="Homeapp">
   
    <div class="container" ng-controller="HomeController">
        <div class="row">
            <div class="col-md-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h3 class="text-center">CRUD Operation in ASP.NET MVC using Angular JS</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-sm-9">
                        <h4>Employee List</h4>
                    </div>
                    <div class="col-sm-3 text-right">
                        <b>@ViewBag.UserInfo</b>
                        <b style="display:none;">@ViewBag.UserRole</b>
                        @Html.ActionLink("Logout", "Logout")
                    </div>
                </div>
                <hr />
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                &nbsp;
            </div>
        </div>
        @if (ViewBag.UserRole == "admin")
        {
        <div class="row">
            <div class="col-md-12">
                <div class="form-inline">
                    <input type="file" name="file" class="form-control" onchange="angular.element(this).scope().UploadFile(this.files)" />
                    <button class="btn btn-primary" type="button" ng-disabled="!SelectedFileForUpload" ng-click="ParseExcelDataAndSave()"><i class="fa fa-upload"></i> Upload</button>
                </div>
            </div>
        </div>
        }
        <div class="row">
            <div class="col-md-12">
                <span class="text-success">
                    {{Message}}
                </span>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 align-content-md-end">
                <div class="card">

                    <table id="dataTable" class="table">
                        <tr class="bg-dark text-light">
                            <th width="80">ID</th>
                            <th>Name</th>
                            <th>Address</th>
                            <th>City</th>
                            @if (ViewBag.UserRole == "admin")
                            {
                                <th width="200" id="actionsHeader">Action</th>
                            }
                            </tr>
                        <tr ng-repeat="e in record" ng-class="'even'" ng-class-odd="'odd'">
                            <td>{{e.empid}}</td>
                            <td>{{e.empname}}</td>
                            <td>{{e.empaddress}}</td>
                            <td>{{e.empcity}}</td>
                            @if (ViewBag.UserRole == "admin")
                            {
                            <td id="actionCol">

                                <a href="/Home/Edit?empid={{e.empid}}" class="btn btn-warning" id="editAction">Edit</a>&nbsp;&nbsp;
                                <a ng-click="deleterecord(e.empid)" class="btn btn-danger" id="deleteAction">Delete</a>
                            </td>
                            }
                        </tr>
                        @if (ViewBag.UserRole == "admin")
                        {
                        <tr>
                            <td colspan="4">
                                @Html.ActionLink("Add", "Add", "Home", new { @class = "btn btn-primary" })
                            </td>
                            <td align="right">
                                <button type="button" class="btn btn-primary" ng-click="export()">
                                    <i class="fa fa-file-excel-o"></i> Export to Excel
                                </button>

                            </td>
                        </tr>
                        }
                    </table>
                    
                </div>
            </div>
        </div>
    </div>

    
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script src="~/Scripts/jquery-3.0.0.min.js"></script>
    <script src="~/Scripts/jquery-3.0.0.slim.min.js"></script>
    <script src="~/Scripts/DOM.js"></script>
    <script src="~/Scripts/jquery-3.0.0.js"></script>
</body>
</html>
